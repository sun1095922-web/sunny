<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3ì¤„ ì„±ì¥ ë…¸íŠ¸</title>
    <meta name="theme-color" content="#3b82f6">
    <meta name="description" content="ë§¤ì¼ 3ì¤„ë¡œ ì„±ì¥ì„ ê¸°ë¡í•˜ê³  ë¶„ì„í•˜ëŠ” ì•±">
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIjPso4Qg7ISx7J6l64W47ZuEIiwKICAic2hvcnRfbmFtZSI6ICLshLHsnqXrhbjthEQiLAogICJkZXNjcmlwdGlvbiI6ICLrp6TsnbwgM+ykhOuhnCDshLHsnqXsnYQg6riw66GdO2VhZCDrtoTshJ3tlZjripQg7JWxIiwKICAic3RhcnRfdXJsIjogIi4vIiwKICAiZGlzcGxheSI6ICJzdGFuZGFsb25lIiwKICAiYmFja2dyb3VuZF9jb2xvciI6ICIjZjlmYWZiIiwKICAidGhlbWVfY29sb3IiOiAiIzNiODJmNiIsCiAgImljb25zIjogWwogICAgewogICAgICAic3JjIjogImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjNhV1IwYUQwaU1USTRJaUJvWldsbmFIUTlJakV5T0NJZ2RtbGxkMEp2ZUQwaU1DQXdJREV5T0NBeU9DSWdabWxzYkQwaUl6TmlPREptTmlJZ2VHMXNibk05SW1oMGRIQTZMeTkzZDNjdWR6TXViM0puTHpJd01EQXZjM1puSWo0OGNtVmpkQ0IzYVdSMGFEMGlNVEk0SWlCb1pXbG5hSFE5SWpFeU9DSWdabWxzYkQwaUkwWkdSa1pHUmlJdmVqNDhkR1Y0ZENCNFBTSTJOQ0lnZVQwaU5qUWlJSFJsZUhRdFlXNWphRzl5UFNKdGFXUmtiR1VpSUdacGJHdzlJaU5tWm1ZaUlHWnZiblF0YzJsNlpUMGlORGdpUGpOOEwyUmxabUU4TDNSbGVIUStQQzl6ZG1jKyIsCiAgICAgICJzaXplcyI6ICIxMjh4MTI4IiwKICAgICAgInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCIKICAgIH0sCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCM2FXUjBhRDBpTWpVMklpQm9aV2xuYUhROUlqSTFOaUlnZG1sbGQwSnZlRDBpTUNBd0lESTFOaUF5TlRZaUlHWnBiR3c5SWlNell6Z3laalppSUhodGJHNXpQU0pvZEhSd09pOHZkM2QzTG5jekxtOXlaeTh5TURBd0wzTjJaeUkrUEhKbFkzUWdkMmxrZEdnOUlqSTFOaUlnYUdWcFoyaDBQU0l5TlRZaUlHWnBiR3c5SWlOR1JrWkdSbVlpTDNvK1BIUmxlSFFnZUQwaU1USTRJaUI1UFNJeE1qZ2lJSFJsZUhRdFlXNWphRzl5UFNKdGFXUmtiR1VpSUdacGJHdzlJaU5tWm1ZaUlHWnZiblF0YzJsNlpUMGlOalFpUGpOOEwyUmxabUU4TDNSbGVIUStQQzl6ZG1jKyIsCiAgICAgICJzaXplcyI6ICIyNTZ4MjU2IiwKICAgICAgInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCIKICAgIH0KICBdCn0=">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, system-ui, sans-serif; 
        }
        .tab-active {
            border-bottom: 2px solid #3b82f6;
            color: #3b82f6;
        }
        .install-prompt {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #3b82f6;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            display: none;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- PWA ì„¤ì¹˜ ì•ˆë‚´ -->
    <div id="installPrompt" class="install-prompt">
        <div class="flex items-center gap-3">
            <span>ğŸ“± ì•±ìœ¼ë¡œ ì„¤ì¹˜í•˜ì‹œê² ì–´ìš”?</span>
            <button id="installBtn" class="bg-white text-blue-600 px-3 py-1 rounded text-sm font-medium">ì„¤ì¹˜</button>
            <button id="dismissBtn" class="text-white/80 text-sm">ë‚˜ì¤‘ì—</button>
        </div>
    </div>

    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- í—¤ë” -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-2">3ì¤„ ì„±ì¥ ë…¸íŠ¸</h1>
            <p class="text-gray-600">ë§¤ì¼ 3ì¤„ë¡œ ì„±ì¥ì„ ê¸°ë¡í•˜ê³  ë¶„ì„í•´ë³´ì„¸ìš”</p>
            <div id="onlineStatus" class="mt-2 text-sm text-green-600">ğŸŸ¢ ì˜¨ë¼ì¸</div>
        </div>

        <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 mb-6">
            <div class="flex">
                <button id="writeTab" class="flex-1 py-4 px-6 text-center font-medium tab-active">
                    ì˜¤ëŠ˜ ê¸°ë¡í•˜ê¸°
                </button>
                <button id="historyTab" class="flex-1 py-4 px-6 text-center font-medium text-gray-500 hover:text-gray-700">
                    ê¸°ë¡ ë³´ê¸°
                </button>
                <button id="statsTab" class="flex-1 py-4 px-6 text-center font-medium text-gray-500 hover:text-gray-700">
                    í†µê³„ ë¶„ì„
                </button>
            </div>
        </div>

        <!-- ê¸°ë¡ ì‘ì„± íƒ­ -->
        <div id="writeSection" class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
            <div class="mb-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-2">ì˜¤ëŠ˜ì˜ 3ì¤„ ê¸°ë¡</h2>
                <div class="text-sm text-gray-500" id="todayDate"></div>
            </div>

            <form id="noteForm" class="space-y-6">
                <div class="border border-green-200 rounded-lg p-4 bg-green-50">
                    <label class="block text-sm font-medium text-green-800 mb-2">
                        ì˜¤ëŠ˜ ë‚´ê°€ í•œ ì¼ ì¤‘ ê°€ì¥ ì˜í•œ ê²ƒ 1ê°€ì§€
                    </label>
                    <textarea id="goodThing" class="w-full p-3 border border-green-200 rounded-md focus:ring-2 focus:ring-green-500 focus:border-green-500 resize-none bg-white" rows="3" placeholder="ì˜ˆ: ìš´ë™ì„ 30ë¶„ ê¾¸ì¤€íˆ í–ˆë‹¤"></textarea>
                </div>

                <div class="border border-orange-200 rounded-lg p-4 bg-orange-50">
                    <label class="block text-sm font-medium text-orange-800 mb-2">
                        ì˜¤ëŠ˜ ë‚´ê°€ í•œ ì¼ ì¤‘ ê°€ì¥ ì•„ì‰¬ì› ë˜ ê²ƒ 1ê°€ì§€
                    </label>
                    <textarea id="regretThing" class="w-full p-3 border border-orange-200 rounded-md focus:ring-2 focus:ring-orange-500 focus:border-orange-500 resize-none bg-white" rows="3" placeholder="ì˜ˆ: ìŠ¤ë§ˆíŠ¸í°ì„ ë„ˆë¬´ ë§ì´ ë´¤ë‹¤"></textarea>
                </div>

                <div class="border border-blue-200 rounded-lg p-4 bg-blue-50">
                    <label class="block text-sm font-medium text-blue-800 mb-2">
                        ë‚´ì¼ ê°œì„ í•  1ê°€ì§€ í–‰ë™
                    </label>
                    <textarea id="improveThing" class="w-full p-3 border border-blue-200 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none bg-white" rows="3" placeholder="ì˜ˆ: ì•„ì¹¨ì— ì¼ì° ì¼ì–´ë‚˜ì„œ ë…ì„œí•˜ê¸°"></textarea>
                </div>

                <button type="submit" class="w-full bg-blue-600 text-white py-3 px-6 rounded-md font-medium hover:bg-blue-700 transition-colors">
                    ì˜¤ëŠ˜ì˜ ê¸°ë¡ ì €ì¥í•˜ê¸°
                </button>
            </form>
        </div>

        <!-- ê¸°ë¡ ë³´ê¸° íƒ­ -->
        <div id="historySection" class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-semibold text-gray-900">ë‚˜ì˜ ì„±ì¥ ê¸°ë¡</h2>
                <div class="flex gap-2">
                    <button id="exportBtn" class="bg-green-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-green-700 transition-colors">
                        ë‚´ë³´ë‚´ê¸°
                    </button>
                    <button id="clearBtn" class="bg-red-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-red-700 transition-colors">
                        ì „ì²´ ì‚­ì œ
                    </button>
                </div>
            </div>
            <div id="historyList" class="space-y-4"></div>
        </div>

        <!-- í†µê³„ ë¶„ì„ íƒ­ -->
        <div id="statsSection" class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 hidden">
            <h2 class="text-xl font-semibold text-gray-900 mb-6">ì„±ì¥ í†µê³„ ë¶„ì„</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                <div class="bg-gray-50 border border-gray-200 p-6 rounded-lg text-center">
                    <div class="text-2xl font-bold text-gray-900" id="totalDays">0</div>
                    <div class="text-sm text-gray-600 mt-1">ì´ ê¸°ë¡ ì¼ìˆ˜</div>
                </div>
                <div class="bg-gray-50 border border-gray-200 p-6 rounded-lg text-center">
                    <div class="text-2xl font-bold text-gray-900" id="weekStreak">0</div>
                    <div class="text-sm text-gray-600 mt-1">ì—°ì† ê¸°ë¡ (ì¼)</div>
                </div>
                <div class="bg-gray-50 border border-gray-200 p-6 rounded-lg text-center">
                    <div class="text-2xl font-bold text-gray-900" id="monthlyAvg">0</div>
                    <div class="text-sm text-gray-600 mt-1">ì›”í‰ê·  ê¸°ë¡</div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div class="bg-gray-50 border border-gray-200 p-4 rounded-lg">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">ì£¼ê°„ ê¸°ë¡ í˜„í™©</h3>
                    <canvas id="weeklyChart" width="400" height="200"></canvas>
                </div>
                <div class="bg-gray-50 border border-gray-200 p-4 rounded-lg">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">ì›”ê°„ ê¸°ë¡ í˜„í™©</h3>
                    <canvas id="monthlyChart" width="400" height="200"></canvas>
                </div>
            </div>

            <div class="bg-gray-50 border border-gray-200 p-4 rounded-lg">
                <h3 class="text-lg font-medium text-gray-900 mb-4">ìì£¼ ë‚˜íƒ€ë‚˜ëŠ” í‚¤ì›Œë“œ</h3>
                <div id="keywordAnalysis" class="grid grid-cols-2 md:grid-cols-4 gap-3"></div>
            </div>
        </div>
    </div>

    <script>
        // PWA ê´€ë ¨ ë³€ìˆ˜
        let deferredPrompt;
        let isInstalled = false;

        // ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('data:text/javascript;base64,Y29uc3QgQ0FDSEVfTkFNRSA9ICdncm93dGgtbm90ZS12MSc7CmNvbnN0IHVybHNUb0NhY2hlID0gWwogICcuLycsCiAgJ2h0dHBzOi8vY2RuLnRhaWx3aW5kY3NzLmNvbS8nLAogICdodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2NoYXJ0LmpzJwpdOwoKc2VsZi5hZGRFdmVudExpc3RlbmVyKCdpbnN0YWxsJywgZXZlbnQgPT4gewogIGV2ZW50LndhaXRVbnRpbCgKICAgIGNhY2hlcy5vcGVuKENBQ0hFX05BTUUpCiAgICAgIC50aGVuKGNhY2hlID0+IGNhY2hlLmFkZEFsbCh1cmxzVG9DYWNoZSkpCiAgKTsKfSk7CgpzZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ2ZldGNoJywgZXZlbnQgPT4gewogIGV2ZW50LnJlc3BvbmRXaXRoKAogICAgY2FjaGVzLm1hdGNoKGV2ZW50LnJlcXVlc3QpCiAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2UpIHsKICAgICAgICAgIHJldHVybiByZXNwb25zZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZldGNoKGV2ZW50LnJlcXVlc3QpOwogICAgICB9KQogICk7Cn0pOw==')
                .then(() => console.log('Service Worker ë“±ë¡ ì™„ë£Œ'))
                .catch(err => console.log('Service Worker ë“±ë¡ ì‹¤íŒ¨:', err));
        }

        // PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ ì²˜ë¦¬
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // ì´ë¯¸ ì„¤ì¹˜ëœ ìƒíƒœê°€ ì•„ë‹ˆë©´ ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ í‘œì‹œ
            if (!isInstalled) {
                document.getElementById('installPrompt').style.display = 'block';
            }
        });

        // ì„¤ì¹˜ ë²„íŠ¼ í´ë¦­
        document.getElementById('installBtn').addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                
                if (outcome === 'accepted') {
                    console.log('PWA ì„¤ì¹˜ë¨');
                    isInstalled = true;
                }
                
                deferredPrompt = null;
                document.getElementById('installPrompt').style.display = 'none';
            }
        });

        // ë‚˜ì¤‘ì— ë²„íŠ¼ í´ë¦­
        document.getElementById('dismissBtn').addEventListener('click', () => {
            document.getElementById('installPrompt').style.display = 'none';
        });

        // ì•±ì´ ì„¤ì¹˜ëœ í›„ ì‹¤í–‰ë  ë•Œ
        window.addEventListener('appinstalled', () => {
            console.log('PWAê°€ ì„¤ì¹˜ë˜ì—ˆìŠµë‹ˆë‹¤');
            isInstalled = true;
            document.getElementById('installPrompt').style.display = 'none';
        });

        // ì˜¨ë¼ì¸/ì˜¤í”„ë¼ì¸ ìƒíƒœ í‘œì‹œ
        function updateOnlineStatus() {
            const statusElement = document.getElementById('onlineStatus');
            if (navigator.onLine) {
                statusElement.textContent = 'ğŸŸ¢ ì˜¨ë¼ì¸';
                statusElement.className = 'mt-2 text-sm text-green-600';
            } else {
                statusElement.textContent = 'ğŸ”´ ì˜¤í”„ë¼ì¸';
                statusElement.className = 'mt-2 text-sm text-red-600';
            }
        }

        window.addEventListener('online', updateOnlineStatus);
        window.addEventListener('offline', updateOnlineStatus);

        // ë°ì´í„° ì €ì¥ì†Œ
        let notes = JSON.parse(localStorage.getItem('growthNotes') || '[]');

        // DOM ìš”ì†Œë“¤
        const writeTab = document.getElementById('writeTab');
        const historyTab = document.getElementById('historyTab');
        const statsTab = document.getElementById('statsTab');
        const writeSection = document.getElementById('writeSection');
        const historySection = document.getElementById('historySection');
        const statsSection = document.getElementById('statsSection');
        const noteForm = document.getElementById('noteForm');
        const todayDate = document.getElementById('todayDate');

        // ì˜¤ëŠ˜ ë‚ ì§œ í‘œì‹œ
        function updateTodayDate() {
            const today = new Date();
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric', 
                weekday: 'long' 
            };
            todayDate.textContent = today.toLocaleDateString('ko-KR', options);
        }

        // íƒ­ ì „í™˜
        function switchTab(activeTab, activeSection) {
            // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
            [writeTab, historyTab, statsTab].forEach(tab => {
                tab.className = 'flex-1 py-4 px-6 text-center font-medium text-gray-500 hover:text-gray-700';
            });
            
            // í™œì„± íƒ­ ìŠ¤íƒ€ì¼ ì ìš©
            activeTab.className = 'flex-1 py-4 px-6 text-center font-medium tab-active';
            
            // ëª¨ë“  ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            [writeSection, historySection, statsSection].forEach(section => {
                section.classList.add('hidden');
            });
            
            // í™œì„± ì„¹ì…˜ ë³´ì´ê¸°
            activeSection.classList.remove('hidden');
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        writeTab.addEventListener('click', () => switchTab(writeTab, writeSection));
        historyTab.addEventListener('click', () => {
            switchTab(historyTab, historySection);
            displayHistory();
        });
        statsTab.addEventListener('click', () => {
            switchTab(statsTab, statsSection);
            displayStats();
        });

        // ë…¸íŠ¸ ì €ì¥
        noteForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const goodThing = document.getElementById('goodThing').value.trim();
            const regretThing = document.getElementById('regretThing').value.trim();
            const improveThing = document.getElementById('improveThing').value.trim();
            
            if (!goodThing || !regretThing || !improveThing) {
                alert('ëª¨ë“  í•­ëª©ì„ ì‘ì„±í•´ì£¼ì„¸ìš”!');
                return;
            }
            
            const today = new Date().toISOString().split('T')[0];
            
            // ì˜¤ëŠ˜ ì´ë¯¸ ì‘ì„±í–ˆëŠ”ì§€ í™•ì¸
            const existingIndex = notes.findIndex(note => note.date === today);
            
            const newNote = {
                date: today,
                goodThing,
                regretThing,
                improveThing,
                timestamp: new Date().toISOString()
            };
            
            if (existingIndex >= 0) {
                notes[existingIndex] = newNote;
                alert('ì˜¤ëŠ˜ì˜ ê¸°ë¡ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!');
            } else {
                notes.push(newNote);
                alert('ì˜¤ëŠ˜ì˜ ê¸°ë¡ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
            }
            
            localStorage.setItem('growthNotes', JSON.stringify(notes));
            noteForm.reset();
        });

        // ê¸°ë¡ íˆìŠ¤í† ë¦¬ í‘œì‹œ
        function displayHistory() {
            const historyList = document.getElementById('historyList');
            
            if (notes.length === 0) {
                historyList.innerHTML = '<div class="text-center text-gray-500 py-8">ì•„ì§ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ ê¸°ë¡ì„ ì‘ì„±í•´ë³´ì„¸ìš”!</div>';
                return;
            }
            
            const sortedNotes = [...notes].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            historyList.innerHTML = sortedNotes.map(note => {
                const date = new Date(note.date);
                const formattedDate = date.toLocaleDateString('ko-KR', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    weekday: 'short'
                });
                
                return `
                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex justify-between items-center mb-3">
                            <h3 class="font-medium text-gray-900">${formattedDate}</h3>
                            <button onclick="deleteNote('${note.date}')" class="text-red-600 hover:text-red-800 text-sm">ì‚­ì œ</button>
                        </div>
                        <div class="space-y-3">
                            <div class="bg-green-50 border border-green-200 p-3 rounded">
                                <div class="text-sm font-medium text-green-800 mb-1">ì˜í•œ ê²ƒ</div>
                                <div class="text-gray-700 text-sm">${note.goodThing}</div>
                            </div>
                            <div class="bg-orange-50 border border-orange-200 p-3 rounded">
                                <div class="text-sm font-medium text-orange-800 mb-1">ì•„ì‰¬ì› ë˜ ê²ƒ</div>
                                <div class="text-gray-700 text-sm">${note.regretThing}</div>
                            </div>
                            <div class="bg-blue-50 border border-blue-200 p-3 rounded">
                                <div class="text-sm font-medium text-blue-800 mb-1">ê°œì„ í•  ê²ƒ</div>
                                <div class="text-gray-700 text-sm">${note.improveThing}</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ë…¸íŠ¸ ì‚­ì œ
        function deleteNote(date) {
            if (confirm('ì´ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                notes = notes.filter(note => note.date !== date);
                localStorage.setItem('growthNotes', JSON.stringify(notes));
                displayHistory();
            }
        }

        // í†µê³„ í‘œì‹œ
        function displayStats() {
            updateBasicStats();
            createWeeklyChart();
            createMonthlyChart();
            analyzeKeywords();
        }

        // ê¸°ë³¸ í†µê³„ ì—…ë°ì´íŠ¸
        function updateBasicStats() {
            document.getElementById('totalDays').textContent = notes.length;
            
            // ì—°ì† ê¸°ë¡ ê³„ì‚°
            const sortedDates = notes.map(note => note.date).sort();
            let streak = 0;
            let currentStreak = 0;
            
            for (let i = sortedDates.length - 1; i >= 0; i--) {
                const date = new Date(sortedDates[i]);
                const today = new Date();
                const diffDays = Math.floor((today - date) / (1000 * 60 * 60 * 24));
                
                if (diffDays === currentStreak) {
                    streak++;
                    currentStreak++;
                } else {
                    break;
                }
            }
            
            document.getElementById('weekStreak').textContent = streak;
            
            // ì›”í‰ê·  ê³„ì‚°
            const monthlyAvg = notes.length > 0 ? Math.round(notes.length / Math.max(1, getMonthsSpan())) : 0;
            document.getElementById('monthlyAvg').textContent = monthlyAvg;
        }

        // ì›” ë²”ìœ„ ê³„ì‚°
        function getMonthsSpan() {
            if (notes.length === 0) return 1;
            
            const dates = notes.map(note => new Date(note.date));
            const minDate = new Date(Math.min(...dates));
            const maxDate = new Date(Math.max(...dates));
            
            return Math.max(1, (maxDate.getFullYear() - minDate.getFullYear()) * 12 + maxDate.getMonth() - minDate.getMonth() + 1);
        }

        // ì£¼ê°„ ì°¨íŠ¸ ìƒì„±
        function createWeeklyChart() {
            const ctx = document.getElementById('weeklyChart').getContext('2d');
            
            // ìµœê·¼ 4ì£¼ ë°ì´í„°
            const weeks = [];
            const today = new Date();
            
            for (let i = 3; i >= 0; i--) {
                const weekStart = new Date(today);
                weekStart.setDate(today.getDate() - (i * 7) - today.getDay());
                const weekEnd = new Date(weekStart);
                weekEnd.setDate(weekStart.getDate() + 6);
                
                const weekNotes = notes.filter(note => {
                    const noteDate = new Date(note.date);
                    return noteDate >= weekStart && noteDate <= weekEnd;
                });
                
                weeks.push({
                    label: `${weekStart.getMonth() + 1}/${weekStart.getDate()}`,
                    count: weekNotes.length
                });
            }
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: weeks.map(w => w.label),
                    datasets: [{
                        label: 'ê¸°ë¡ ìˆ˜',
                        data: weeks.map(w => w.count),
                        backgroundColor: 'rgba(59, 130, 246, 0.5)',
                        borderColor: 'rgba(59, 130, 246, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 7
                        }
                    }
                }
            });
        }

        // ì›”ê°„ ì°¨íŠ¸ ìƒì„±
        function createMonthlyChart() {
            const ctx = document.getElementById('monthlyChart').getContext('2d');
            
            // ìµœê·¼ 6ê°œì›” ë°ì´í„°
            const months = [];
            const today = new Date();
            
            for (let i = 5; i >= 0; i--) {
                const month = new Date(today.getFullYear(), today.getMonth() - i, 1);
                const monthEnd = new Date(today.getFullYear(), today.getMonth() - i + 1, 0);
                
                const monthNotes = notes.filter(note => {
                    const noteDate = new Date(note.date);
                    return noteDate >= month && noteDate <= monthEnd;
                });
                
                months.push({
                    label: `${month.getMonth() + 1}ì›”`,
                    count: monthNotes.length
                });
            }
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: months.map(m => m.label),
                    datasets: [{
                        label: 'ê¸°ë¡ ìˆ˜',
                        data: months.map(m => m.count),
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderColor: 'rgba(16, 185, 129, 1)',
                        borderWidth: 2,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // í‚¤ì›Œë“œ ë¶„ì„
        function analyzeKeywords() {
            const keywordAnalysis = document.getElementById('keywordAnalysis');
            
            if (notes.length === 0) {
                keywordAnalysis.innerHTML = '<div class="col-span-full text-center text-gray-500 py-4">ë¶„ì„í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }
            
            // ëª¨ë“  í…ìŠ¤íŠ¸ í•©ì¹˜ê¸°
            const allText = notes.map(note => 
                `${note.goodThing} ${note.regretThing} ${note.improveThing}`
            ).join(' ');
            
            // ê°„ë‹¨í•œ í‚¤ì›Œë“œ ì¶”ì¶œ (í•œê¸€ 2ê¸€ì ì´ìƒ)
            const words = allText.match(/[ê°€-í£]{2,}/g) || [];
            const wordCount = {};
            
            words.forEach(word => {
                wordCount[word] = (wordCount[word] || 0) + 1;
            });
            
            // ìƒìœ„ 8ê°œ í‚¤ì›Œë“œ
            const topWords = Object.entries(wordCount)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 8);
            
            keywordAnalysis.innerHTML = topWords.map(([word, count]) => `
                <div class="bg-white border border-gray-200 p-3 rounded text-center">
                    <div class="font-medium text-gray-900">${word}</div>
                    <div class="text-sm text-gray-500">${count}íšŒ</div>
                </div>
            `).join('');
        }

        // ë°ì´í„° ë‚´ë³´ë‚´ê¸°
        document.getElementById('exportBtn').addEventListener('click', () => {
            const dataStr = JSON.stringify(notes, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `ì„±ì¥ë…¸íŠ¸_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
        });

        // ì „ì²´ ì‚­ì œ
        document.getElementById('clearBtn').addEventListener('click', () => {
            if (confirm('ì •ë§ë¡œ ëª¨ë“  ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                notes = [];
                localStorage.removeItem('growthNotes');
                displayHistory();
                alert('ëª¨ë“  ê¸°ë¡ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì˜¤ëŠ˜ ê¸°ë¡ì´ ìˆëŠ”ì§€ í™•ì¸
        function checkTodayNote() {
            const today = new Date().toISOString().split('T')[0];
            const todayNote = notes.find(note => note.date === today);
            
            if (todayNote) {
                document.getElementById('goodThing').value = todayNote.goodThing;
                document.getElementById('regretThing').value = todayNote.regretThing;
                document.getElementById('improveThing').value = todayNote.improveThing;
            }
        }

        // ì´ˆê¸°í™”
        updateTodayDate();
        checkTodayNote();
        updateOnlineStatus();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'980466ce11e6d1e6',t:'MTc1ODA2ODA0Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
